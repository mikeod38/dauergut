<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Figure 2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Rictor/TORC2 mediates gut-to-brain signaling in the regulation of phenotypic plasticity in C.elegans</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    home
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about.html">raw data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Figures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Figure_1.html">Figure 1</a>
    </li>
    <li>
      <a href="Figure_2.html">Figure 2</a>
    </li>
    <li>
      <a href="Figure_3.html">Figure 3</a>
    </li>
    <li>
      <a href="Figure_4.html">Figure 4</a>
    </li>
    <li>
      <a href="Figure_5.html">Figure 5</a>
    </li>
    <li>
      <a href="Figure_6.html">Figure 6</a>
    </li>
    <li>
      <a href="Figure_7.html">Figure 7</a>
    </li>
    <li>
      <a href="Figure_8.html">Figure 8</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Figure 2</h1>

</div>


<div id="intestinal-mtorc2-regulates-sensory-neuron-state" class="section level1 tabset">
<h1><strong>Intestinal mTORC2 regulates sensory neuron state</strong></h1>
<div id="a" class="section level2">
<h2>2A</h2>
<pre class="r"><code>strains&lt;-c(&quot;N2&quot;,&quot;mg360&quot;,&quot;ft7&quot;,&quot;ft7_ges1resc&quot;)
dates&lt;-c(&quot;10_22_16&quot;, &quot;11_9_16&quot;, &quot;11_23_16&quot;) #dropped &quot;12_6_16&quot; due to missingness
d7GFP&lt;-read.csv(file.path(pathname,&quot;extdata/2A_3A_daf7GFP.csv&quot;)) %&gt;% filter(mean!=4095 &amp; genotype %in% strains &amp; date %in% dates &amp; temp == &quot;27&quot; &amp; food == &quot;OP50&quot;) %&gt;% mutate(genotype = factor(genotype, levels=strains), ID = as.character(ID)) %&gt;%
  separate(ID, c(&quot;ID.A&quot;, &quot;ID.B&quot;), sep = &quot;:&quot;, extra = &quot;drop&quot;) %&gt;% 
  mutate(genoID = paste(date, genotype, ID.A, sep = &quot;:&quot;), cell.norm = mean) #genoID is animal, 2 cells per animal measured.

df &lt;- d7GFP %&gt;% group_by(date, genotype, genoID) %&gt;% summarise(cell.norm = mean(cell.norm)) # take mean of each worm

### Linear models ###

log.tran&lt;-lsmeans::make.tran(type=&quot;genlog&quot;, param = c(0,10))
lmm2&lt;-with(log.tran, lmer(linkfun(cell.norm) ~ genotype + (1|date) + (1|genotype:date), data = df))
lm &lt;- with(log.tran, lm(linkfun(cell.norm) ~ genotype, data = df))
stanlmer &lt;- with(log.tran, rstanarm::stan_lmer(linkfun(cell.norm) ~ genotype + (1|date) + (1:genotype:date), 
                                               data = df, 
                                               chains = 3, 
                                               cores =4, 
                                               seed = 2000,
                                               iter=6000,
                                               control = list(adapt_delta=0.99)))

### compare ft7 to rescue H0, ft7 = ft7_resc ###
rescue.test &lt;- d7GFP %&gt;% subset(genotype %in% c(&quot;ft7&quot;, &quot;ft7_ges1resc&quot;)) %$% with(log.tran, t.test(linkfun(cell.norm) ~ genotype))
rescue.p &lt;- data.frame(p.value = rescue.test$p.value) %&gt;% dauergut::prange()

#H0, all genotypes = N2
contrasts&lt;-dauergut::dunnett_contrasts(lm, ref.index = 1, &quot;genotype&quot;)
mixed &lt;- stanlmer %&gt;% getStan_CIs(type = &quot;log&quot;, base = 10)

plot.contrasts&lt;-c(&quot;&quot;,contrasts$prange[1:2],&quot;&quot;)
plot.contrasts.2 &lt;- c(&quot;&quot;, &quot;&quot;, &quot;&quot;, rescue.p$prange)

labels &lt;- c(&quot;WT&quot;,&quot;rict-1(mg360)&quot;,&quot;rict-1(ft7)&quot;,&quot;rict-1(ft7); +ges1p::rict-1&quot;) %&gt;% stringr::str_wrap(width = 10)

p2&lt;-dauergut::plot_CIs(df=df, title=&#39;daf-7 expression in ASI at 27º is
controlled by intestinal rict-1&#39;, plot.contrasts=plot.contrasts, plot.contrasts.2 = plot.contrasts.2, ypos = 4700, offset = 0, type = &quot;GFP&quot;, labels = labels)

img.path &lt;- file.path(pathname,&quot;figures/2A_daf7GFP.png&quot;)</code></pre>
<div style="float: left; width: 425;">
<pre class="r"><code>include_graphics(img.path)                                   </code></pre>
<p><img src="figures/2A_daf7GFP.png" width="200" /></p>
</div>
<div style="float: left; width: 425;">
<pre class="r"><code>p2</code></pre>
<p><img src="Figure_2_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div style="float: right; width: 100%;">
<p><strong>Figure 2A</strong><br />
Intesinal <em>rict-1</em> regulates daf7GFP levels in ASI neurons. Daf-7::GFP fluorescence quantification shows decreased expression in <em>rict-1</em> mutants. Intestinal expression of <em>rict-1</em> using the intestinal <em>ges-1</em> promoter rescues daf-7::GFP expression. (Left) Representative images of <em>daf-7p::gfp</em> expression in one of the bilateral ASI neurons in animals of the indicated genotypes. Yellow filled and open arrowheads indicate ASI and ASJ soma, respectively. Anterior is at left. Scale bar: 5 μm. (Right) Quantification of daf-7p::gfp expression in ASI (A) and daf-28p::gfp expression in ASI and ASJ (D). Each dot is the mean fluorescence intensity in a single animal (2 neurons per animal); numbers in parentheses below indicate the number of animals examined in 3 independent experiments. Horizontal thick bar indicates median. Error bars are quartiles. Light gray thin and thick vertical bars at right indicate Bayesian 95% and 75% credible intervals, respectively. <span style="color:black"><code>**</code></span> and <span style="color:black"><code>***</code></span> - different from wild-type at P&lt;0.01 and P&lt;0.001, respectively; <span style="color:red"><code>***</code></span> - different from rict-1(ft7) at P&lt;0.001 (ANOVA with Dunnett-type multivariate-t post-hoc adjustment). P-values of differences in means relative to wild-type and corresponding mutant animals are indicated in black and red, respectively.</p>
<!-- L1 animals were grown 18hrs post egg lay at 27º. Daf-7::GFP fluorescence quantification shows decreased expression in _rict-1_ mutants. Intestinal expression of _rict-1_ using the intestinal _ges-1_ promoter rescues daf-7::GFP expression. Box and scatter plot show raw data. Bayesian 90% (grey) and 50% (red) credible intervals are shown on the right (see methods). For _rict-1(mg360)_ and _rict-1(ft7)_, *** and ** compared to N2, respectively. For _ges-1_ rescue, *** compared to _rict-1(ft7)_. n=3 independent experiments. -->
</div>
<pre class="r"><code>knitr::kable(contrasts, caption=&quot;Pairwise comparisons from mixed-effects model (Tukey)&quot;)</code></pre>
<table>
<caption>Pairwise comparisons from mixed-effects model (Tukey)</caption>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
<th align="left">prange</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mg360 - N2</td>
<td align="right">-0.3044202</td>
<td align="right">0.0444226</td>
<td align="right">122</td>
<td align="right">-6.8528183</td>
<td align="right">0.0000000</td>
<td align="left">***</td>
</tr>
<tr class="even">
<td align="left">ft7 - N2</td>
<td align="right">-0.1504361</td>
<td align="right">0.0447683</td>
<td align="right">122</td>
<td align="right">-3.3603231</td>
<td align="right">0.0029983</td>
<td align="left">**</td>
</tr>
<tr class="odd">
<td align="left">ft7_ges1resc - N2</td>
<td align="right">0.0151539</td>
<td align="right">0.0463634</td>
<td align="right">122</td>
<td align="right">0.3268511</td>
<td align="right">0.9772208</td>
<td align="left">p~0.98</td>
</tr>
</tbody>
</table>
<pre class="r"><code>knitr::kable(mixed[,c(6,1:5)], caption = &quot;Bayesian credible intervals&quot;)</code></pre>
<table>
<caption>Bayesian credible intervals</caption>
<thead>
<tr class="header">
<th align="left">genotype</th>
<th align="right">mean</th>
<th align="right">lower.CL</th>
<th align="right">upper.CL</th>
<th align="right">lower.25</th>
<th align="right">upper.75</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N2</td>
<td align="right">2275.739</td>
<td align="right">1761.2710</td>
<td align="right">2888.819</td>
<td align="right">2014.048</td>
<td align="right">2569.422</td>
</tr>
<tr class="even">
<td align="left">mg360</td>
<td align="right">1136.878</td>
<td align="right">935.5569</td>
<td align="right">1379.605</td>
<td align="right">1014.621</td>
<td align="right">1276.525</td>
</tr>
<tr class="odd">
<td align="left">ft7</td>
<td align="right">1618.394</td>
<td align="right">1324.9295</td>
<td align="right">1974.714</td>
<td align="right">1439.280</td>
<td align="right">1816.943</td>
</tr>
<tr class="even">
<td align="left">ft7_ges1resc</td>
<td align="right">2360.091</td>
<td align="right">1913.6245</td>
<td align="right">2904.107</td>
<td align="right">2088.122</td>
<td align="right">2661.336</td>
</tr>
</tbody>
</table>
</div>
<div id="b" class="section level2">
<h2>2B</h2>
<pre class="r"><code>daf7FISH&lt;-read.csv(&quot;extdata/2B_daf7FISH_4frames.csv&quot;) %&gt;%
  separate(Label, c(&quot;method&quot;,&quot;group&quot;,&quot;sample&quot;),sep = c(&quot;-&quot;), extra = &quot;drop&quot;) %&gt;%
  separate(sample, c(&quot;sample&quot;, &quot;type&quot;),sep =&quot;:&quot;, extra = &quot;drop&quot;) %&gt;%
  mutate(genotype = data.frame(do.call(rbind, strsplit(as.vector(group), split = &quot;daf7_mRNA_L1_27d_&quot;)))[,2]) %&gt;%
  mutate(ID = interaction(genotype, sample)) %&gt;%
  mutate(genotype = factor(genotype, levels = c(&quot;N2&quot;, &quot;ft7&quot;, &quot;mg360&quot;, &quot;mg360resc&quot;)))

#measured background fluorescence of each of 4 frames to normalize the sum projection of the neuron
#merge to add mean background value to each row:
background &lt;- filter(daf7FISH, type == &quot;background&quot;) %&gt;% dplyr::select(ID, mean)
colnames(background) &lt;- c(&quot;ID&quot;, &quot;background&quot;)

cells&lt;-dplyr::filter(daf7FISH, type == &quot;cell&quot;) %&gt;% dplyr::select(ID, sample, mean, genotype)
colnames(cells) &lt;- c(&quot;ID&quot;, &quot;sample&quot;, &quot;cell.mean&quot;, &quot;genotype&quot;)

daf7FISH &lt;- merge(cells, background,by=&quot;ID&quot;) %&gt;%
  mutate(cell.norm = cell.mean - mean(background),
         cell.diffnorm = cell.mean - background,
         cell.ratioNorm = cell.mean / background)

#simple lm
lm&lt;-lm(data=daf7FISH, formula=cell.norm~genotype)
#check for outliers
daf7FISH &lt;- dauergut::flag_outliers(lm, daf7FISH, threshold = 4, noplot = TRUE)

lm.0&lt;-lm(data=daf7FISH[daf7FISH$outlier.status == FALSE,], formula=cell.norm~1)
lm.1&lt;-lm(data=daf7FISH[daf7FISH$outlier.status == FALSE,], formula=cell.norm~genotype)
#anova(lm.0, lm.1) p ~ 0.013

stanlm &lt;- stan_glm(cell.norm ~ genotype, data = daf7FISH[daf7FISH$outlier.status == FALSE,])


#plot daf7 FISH
strains &lt;- levels(daf7FISH$genotype)
contrasts &lt;- dauergut::dunnett_contrasts(lm.1,ref.index = 1,&quot;genotype&quot;)
mixed &lt;- stanlm %&gt;% dauergut::getStan_CIs()
rescue.test &lt;- daf7FISH[daf7FISH$outlier.status == FALSE,] %&gt;% subset(genotype %in% c(&quot;mg360&quot;, &quot;mg360resc&quot;)) %$% t.test(cell.norm ~ genotype)
rescue.p &lt;- data.frame(p.value = rescue.test$p.value) %&gt;% dauergut::prange()

plot.contrasts &lt;- c(&quot;&quot;, contrasts$prange[1:2],&quot;&quot;)
plot.contrasts.2 &lt;- c(&quot;&quot;, &quot;&quot;, &quot;&quot;, rescue.p$prange)

labels &lt;- c(&quot;WT&quot;,&quot;rict-1(ft7)&quot;,&quot;rict-1(mg360)&quot; ,&quot;rict-1(mg360); +ges1p::rict-1&quot;) %&gt;% stringr::str_wrap(width = 10)

dauergut::plot_CIs(daf7FISH[daf7FISH$outlier.status == FALSE,], title = &quot;daf7 mRNA is reduced in rict-1 mutants&quot;, plot.contrasts = plot.contrasts, plot.contrasts.2 = plot.contrasts.2, ypos = 150, offset = 0, type = &quot;expression&quot;, labels = labels)</code></pre>
<p><img src="Figure_2_files/figure-html/daf7%20FISH-1.png" width="672" /></p>
<p><strong>Figure 2B</strong> <em>daf-7</em> mRNA is reduced in <em>rict-1</em> mutants. Intestinal expression of <em>rict-1</em> using the intestinal <em>ges-1</em> promoter rescues <em>daf-7</em> expression. Quantification of <em>daf-7</em> mRNA levels in ASI assessed via fluorescent in situ hybridization. Expression was normalized by subtracting mean background pixel values for each image. Each dot is the fluorescence intensity in a single ASI neuron; numbers in parentheses below indicate the number of neurons examined in 3 independent pooled experiments. Horizontal thick bar indicates median. Error bars are quartiles. Light gray thin and thick vertical bars at right indicate Bayesian 95% and 75% credible intervals, respectively. P-values of differences relative to wild-type and rict-1(mg360) animals are indicated in black and red, respectively. For <em>rict-1(mg360)</em> and <em>rict-1(ft7)</em>, p~0.04 and p~0.032 compared to N2, respectively. For <em>ges-1</em> rescue, <span style="color:red">p~0.038</span> compared to <em>rict-1(ft7)</em>. n=2 independent experiments, pooled data. 2 outlier data points were removed in total. P-values of differences in means relative to wild-type and corresponding mutant animals are indicated in black and red, respectively.</p>
</div>
<div id="c" class="section level2">
<h2>2C</h2>
<pre class="r"><code>foods &lt;- &quot;OP50&quot;
strains&lt;-c(&quot;N2&quot;,&quot;rict-1(ft7)&quot;,&quot;rict-1(ft7); ex[ASI::daf7]&quot;,&quot;rict-1(ft7); ex[ASI::daf28]&quot;,&quot;rict-1(ft7); ex[ASJ::daf28]&quot;)
daf7supp&lt;-read.csv(file.path(pathname, &quot;extdata/2C_daf7_daf28_suppression.csv&quot;)) %&gt;% format_dauer(p.dauer = &quot;non&quot;)

# daf7supp$genotype&lt;- factor(daf7supp$genotype, levels = strains)
# daf7supp$pct&lt;-as.numeric(paste(daf7supp$dauer/(daf7supp$dauer+daf7supp$pd + daf7supp$non))) #omitted arrest
# daf7supp$non.dauer&lt;-as.numeric(paste(daf7supp$pd+daf7supp$non))

lm &lt;- daf7supp %&gt;% dauer_ANOVA()
#stan
stan.glmm &lt;- daf7supp %&gt;% dauergut::run_dauer_stan()</code></pre>
<pre class="r"><code>foods &lt;- &quot;OP50&quot;
contrasts&lt;-dauergut::tukey_contrasts(lm, &quot;genotype&quot;)
mixed&lt;-stan.glmm %&gt;% dauergut::getStan_CIs(type = &quot;dauer&quot;)
plot.contrasts&lt;-c(&quot;&quot;,contrasts$prange[1],&quot;&quot;,&quot;&quot;,&quot;&quot;)
plot.contrasts.2&lt;-c(&quot;&quot;, &quot;&quot;, contrasts$prange[5:7]) #for rescue vs rict-1

labels &lt;- c(&quot;WT&quot;,&quot;rict-1(ft7)&quot;,&quot;rict-1(ft7); +ASIp::daf-7&quot;,&quot;rict-1(ft7); +ASIp::daf-28&quot;,&quot;rict-1(ft7); +ASJp::daf-28&quot;) %&gt;% stringr::str_wrap(width = 10)


p&lt;-dauergut::plot_CIs(daf7supp, title=&#39;daf-7 expression in ASI suppresses rict-1 dauer phenotype&#39;, plot.contrasts, plot.contrasts.2, ypos = 1.075, offset = 0, type = &quot;dauer&quot;, labels = labels)</code></pre>
<div style="float: left; width: 60%;">
<pre class="r"><code>p</code></pre>
<p><img src="Figure_2_files/figure-html/unnamed-chunk-3-1.png" width="384" /></p>
</div>
<p><br> <br> </br> <strong>Figure 2C</strong> Expression of <em>daf-7</em> in ASI or <em>daf-28</em> in ASI or ASJ suppressed aberrent dauer formation in <em>rict-1</em> mutants. Dauers formed by animals of the indicated genotypes at 27°C. Each black dot indicates the average number of dauers formed in a single assay. Horizontal black bar indicates median. Light gray thin and thick vertical bars at right indicate Bayesian 95% and 75% credible intervals, respectively. Numbers in parentheses below indicate the number of independent experiments with at least 36 and 9 animals each scored for non-transgenic and transgenic animals, respectively. Promoters driving expression in ASI and ASJ were srg-47p and trx-1p, respectively. One transgenic line was tested for each condition. <span style="color:red"><code>***</code></span> - different from wild-type at P&lt;0.001; <span style="color:red"><code>**</code></span> and <span style="color:red"><code>***</code></span> - different from <em>rict-1(ft7)</em> at P&lt;0.01 and P&lt;0.001, respectively (ANOVA with Tukey-type multivariate-t post-hoc adjustment). P-values of differences in means relative to wild-type and corresponding mutant animals are indicated in black and red, respectively.</p>
</div>
<div id="d" class="section level2">
<h2>2D</h2>
<pre class="r"><code>#days = as.factor(8:10) # days containing N2 and ft7 27º data
days = as.factor(8:10)
strains = c(&quot;N2&quot;, &quot;ft7&quot;)
foods = &quot;OP50&quot;
d28&lt;-read.csv(&#39;extdata/2D_3B_4B_daf-28_GFP_rict-1.csv&#39;) %&gt;%
separate(ID, c(&quot;ID.A&quot;, &quot;ID.B&quot;), sep = &quot;:&quot;, extra = &quot;drop&quot;) %&gt;%
  subset(mean!=4095 &amp; food == foods &amp; temp == &quot;27&quot; &amp; genotype %in% strains &amp; pheromone == 0) %&gt;%
  mutate(day = as.factor(day), genotype = factor(genotype, levels = strains),
         genoID = interaction(date,genotype, ID.A))

df &lt;- d28 %&gt;% subset(day %in% days) %&gt;% group_by(date,genotype,neuron,genoID) %&gt;% summarise(cell.norm = mean(mean)) %&gt;%
  data.frame() %&gt;% mutate(group.id = interaction(genotype, neuron)) # take mean of each worm</code></pre>
<pre class="r"><code>#fit simple linmod to est outliers:
log.tran&lt;-lsmeans::make.tran(type=&quot;genlog&quot;, param = c(0,10)) #make log10 transformation
lm1 &lt;- with(log.tran, lm(linkfun(cell.norm) ~ neuron * genotype, data = df))
df %&lt;&gt;% flag_outliers(lin.mod=lm1, threshold = 4, df = ., noplot=TRUE)

# linear MM
lm &lt;- with(log.tran, lm(linkfun(cell.norm) ~ neuron * genotype, data = df[df$outlier.status==FALSE,]))
stanlmer &lt;- with(log.tran, stan_lmer(linkfun(cell.norm) ~ 1 + group.id + (1|date) + (1:group.id:date), data = df))


contrasts&lt;-summary(lsmeans::lsmeans(lm, pairwise ~ genotype | neuron)$contrasts) %&gt;% dauergut::prange()
mixed &lt;- stanlmer %&gt;% getStan_CIs(type = &quot;log&quot;, group = &quot;neuron&quot;, base = 10, compare_gt = TRUE)
plot.contrasts&lt;-c(&quot;&quot;,contrasts$prange[1],&quot;&quot;, contrasts$prange[2])

labels &lt;- c(&quot;WT&quot;, &quot;rict-1(ft7)&quot;)
#### plot ######
p&lt;-(df %&gt;% ggplot(aes(x=genotype, y = cell.norm)) +
       geom_quasirandom(aes(y=cell.norm, pch = date),cex=1,colour = &quot;#339900&quot;,
                           width = 0.075,size=0.3,
                           method = &#39;smiley&#39;) +
       guides(pch=FALSE) +
       list(dauergut::add.median(width = 0.25), dauergut::add.quartiles()) +
       labs(title = &quot;daf-28 is also reduced in rict-1 mutants&quot;,
           y = &quot;mean GFP intensity&quot;, x=&quot;genotype&quot;) +
       stat_summary(aes(x=genotype, group = genotype, y = 3500), geom=&quot;text&quot;, fun.data=box_annot,
                    label=plot.contrasts, size = 6) +
       add.Bayes.CI() +
       stat_summary(aes(x=as.numeric(as.factor(genotype)) + 0.3,y=0,group = genotype),
                    fun.data = fun_length, geom = &quot;text&quot;,size = 4) +
       facet_grid(.~neuron) + theme_classic() +
       scale_x_discrete(labels = labels) +
       theme(strip.background = element_blank(),
             strip.text = element_text(size = 16,face=&quot;bold&quot;),
             axis.text.y = element_text(size=12),
        axis.text.x = element_text(size = 16, face = &quot;italic&quot;),
        axis.title = element_text(size=16),
        panel.spacing.x=unit(2,&quot;lines&quot;)))

#image of daf-28 GFP
img.path &lt;- file.path(pathname,&quot;figures/2D_daf-28GFP.png&quot;)</code></pre>
<div style="float: left; width: 425;">
<pre class="r"><code>include_graphics(img.path)                                   </code></pre>
<p><img src="figures/2D_daf-28GFP.png" width="195" /></p>
</div>
<div style="float: left; width: 425;">
<pre class="r"><code>p</code></pre>
<p><img src="Figure_2_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div style="float: right; width: 100%;">
<p><strong>Figure 2D</strong> (Left) Representative images of daf-7p::gfp (A) and daf-28p::gfp (D) expression in one of the bilateral ASI (A), and ASI and ASJ (D), neurons in animals of the indicated genotypes. Yellow filled and open arrowheads indicate ASI and ASJ soma, respectively. Anterior is at left. Scale bar: 5 μm. (Right) Quantification of daf-7p::gfp expression in ASI (A) and daf-28p::gfp expression in ASI and ASJ (D). Each dot is the mean fluorescence intensity in a single animal (2 neurons per animal); numbers in parentheses below indicate the number of animals examined in 3 independent experiments. Horizontal thick bar indicates median. Error bars are quartiles. Light gray thin and thick vertical bars at right indicate Bayesian 95% and 75% credible intervals, respectively. <span style="color:black"><code>**</code></span> and <span style="color:black"><code>***</code></span> - different from wild-type at P&lt;0.01 and P&lt;0.001, respectively; <span style="color:red"><code>***</code></span> - different from rict-1(ft7) at P&lt;0.001 (ANOVA with Tukey-type multivariate-t post-hoc adjustment). P-values of differences in means relative to wild-type and corresponding mutant animals are indicated in black and red, respectively.</p>
</div>
<pre class="r"><code>knitr::kable(contrasts, caption = &quot;pairwise comparisons (Tukey)&quot;)</code></pre>
<table>
<caption>pairwise comparisons (Tukey)</caption>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">neuron</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
<th align="left">prange</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N2 - ft7</td>
<td align="left">ASI</td>
<td align="right">0.1186928</td>
<td align="right">0.0452504</td>
<td align="right">109</td>
<td align="right">2.623019</td>
<td align="right">0.0099634</td>
<td align="left">**</td>
</tr>
<tr class="even">
<td align="left">N2 - ft7</td>
<td align="left">ASJ</td>
<td align="right">0.1458524</td>
<td align="right">0.0424608</td>
<td align="right">109</td>
<td align="right">3.434987</td>
<td align="right">0.0008393</td>
<td align="left">***</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ASI &lt;- with(df[df$neuron == &quot;ASI&quot; &amp; df$outlier.status == FALSE,], with(log.tran, t.test(cell.norm ~genotype))) %&gt;% unlist %&gt;% data.frame()
ASJ &lt;- with(df[df$neuron == &quot;ASJ&quot; &amp; df$outlier.status == FALSE,], with(log.tran, t.test(cell.norm ~genotype))) %&gt;% unlist %&gt;% data.frame()
cbind(ASI,ASJ) %&gt;% `colnames&lt;-`(c(&#39;ASI&#39;,&#39;ASJ&#39;)) %&gt;% knitr::kable(caption=&quot;paiwise comparisons (t-test)&quot;)</code></pre>
<table>
<caption>paiwise comparisons (t-test)</caption>
<thead>
<tr class="header">
<th></th>
<th align="left">ASI</th>
<th align="left">ASJ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>statistic.t</td>
<td align="left">2.17270528852315</td>
<td align="left">5.04968092233396</td>
</tr>
<tr class="even">
<td>parameter.df</td>
<td align="left">38.4345401098176</td>
<td align="left">53.0012476671454</td>
</tr>
<tr class="odd">
<td>p.value</td>
<td align="left">0.0360336920779199</td>
<td align="left">0.00000557362812759223</td>
</tr>
<tr class="even">
<td>conf.int1</td>
<td align="left">30.1321039526107</td>
<td align="left">183.880443492934</td>
</tr>
<tr class="odd">
<td>conf.int2</td>
<td align="left">848.267088904532</td>
<td align="left">426.209623173732</td>
</tr>
<tr class="even">
<td>estimate.mean in group N2</td>
<td align="left">1664.2544</td>
<td align="left">1073.33463333333</td>
</tr>
<tr class="odd">
<td>estimate.mean in group ft7</td>
<td align="left">1225.05480357143</td>
<td align="left">768.2896</td>
</tr>
<tr class="even">
<td>null.value.difference in means</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td>alternative</td>
<td align="left">two.sided</td>
<td align="left">two.sided</td>
</tr>
<tr class="even">
<td>method</td>
<td align="left">Welch Two Sample t-test</td>
<td align="left">Welch Two Sample t-test</td>
</tr>
<tr class="odd">
<td>data.name</td>
<td align="left">cell.norm by genotype</td>
<td align="left">cell.norm by genotype</td>
</tr>
</tbody>
</table>
</div>
<div id="s1a" class="section level2">
<h2>S1A</h2>
<pre class="r"><code>strains&lt;-c(&quot;N2&quot;,&quot;rict-1(mg360)&quot;,&quot;rict-1;daf-16&quot;)
foods &lt;- &quot;OP50&quot;
daf16supp&lt;-read.csv(file.path(pathname, &quot;extdata/S1A_daf16_suppression.csv&quot;)) %&gt;% format_dauer(.,p.dauer = &quot;dauer&quot;)

# daf28supp$genotype&lt;- factor(daf28supp$genotype, levels = strains)
# daf28supp$pct&lt;-as.numeric(paste(daf28supp$dauer/(daf28supp$dauer+daf28supp$pd + daf28supp$non))) #omitted arrest
# daf28supp$non.dauer&lt;-as.numeric(paste(daf28supp$pd+daf28supp$non))
lm &lt;- daf16supp %&gt;% dauer_ANOVA()
#stan
stan.glmm &lt;- daf16supp %&gt;% stan_glmer(formula = cbind((dauer+pd), (n-(dauer+pd))) ~ genotype + (1|day) + (1|strainDate) + (1|plateID),
                       data=.,
                       family = binomial(link=&quot;logit&quot;),
                       chains = 3, cores =4, seed = 2000,iter=6000,
                       control = list(adapt_delta=0.99))</code></pre>
<pre class="r"><code>contrasts&lt;-dauergut::tukey_contrasts(lm, &quot;genotype&quot;)
mixed&lt;-stan.glmm %&gt;% getStan_CIs(type=&quot;dauer&quot;)
plot.contrasts&lt;-c(&quot;&quot;,contrasts$prange[1],&quot;&quot;)
plot.contrasts.2&lt;-c(&quot;&quot;, &quot;&quot;, contrasts$prange[3]) #for rescue vs rict-1

labels &lt;- c(&quot;WT&quot;,&quot;rict-1(mg360)&quot;,&quot;daf-16(mu86; rict-1(mg360)&quot;) %&gt;% stringr::str_wrap(width = 10)

p&lt;-dauergut::plot_CIs(daf16supp, title=&#39;rict-1 acts in the insulin pathway to inhibit dauer formation&#39;, plot.contrasts, plot.contrasts.2, ypos = 1.075, offset = 0, type = &quot;dauer&quot;, labels = labels)</code></pre>
<div style="float: left; width: 60%;">
<pre class="r"><code>p</code></pre>
<p><img src="Figure_2_files/figure-html/unnamed-chunk-6-1.png" width="384" /></p>
</div>
<p><br> <br> </br> <strong>Figure S1A</strong> Mutations in rict-1 modulate dauer formation via downregulation of neuroendocrine signaling. <em>daf-16</em> mutations partially suppress the dauer formation phenotype of <em>rict-1</em> mutants. Dauers formed by animals of the indicated genotypes at 27°C. Each dot indicates the proportion of dauers formed in a single assay. Horizontal bar indicates median. Light gray thin and thick vertical bars at right indicate Bayesian 95% and 75% credible intervals, respectively. Numbers in parentheses below indicate the number of independent experiments with at least 26 animals each. <span style="color:black"><code>***</code></span> - different from wild-type at P&lt;0.001, <span style="color:red"><code>***</code></span> - different from rict-1(mg360) at P&lt;0.001 (ANOVA with Tukey-type multivariate-t post-hoc adjustments). P-values of differences in means relative to wild-type and corresponding mutant animals are indicated in black and red, respectively.</p>
<table>
<caption>paiwrise comparisons (Tukey)</caption>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
<th align="left">prange</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N2 - rict-1(mg360)</td>
<td align="right">-0.7259908</td>
<td align="right">0.0585246</td>
<td align="right">15</td>
<td align="right">-12.404877</td>
<td align="right">0.0000000</td>
<td align="left">***</td>
</tr>
<tr class="even">
<td align="left">N2 - rict-1;daf-16</td>
<td align="right">-0.4360625</td>
<td align="right">0.0585246</td>
<td align="right">15</td>
<td align="right">-7.450922</td>
<td align="right">0.0000085</td>
<td align="left">***</td>
</tr>
<tr class="odd">
<td align="left">rict-1(mg360) - rict-1;daf-16</td>
<td align="right">0.2899283</td>
<td align="right">0.0585246</td>
<td align="right">15</td>
<td align="right">4.953954</td>
<td align="right">0.0004155</td>
<td align="left">***</td>
</tr>
</tbody>
</table>
</div>
<div id="s1b" class="section level2">
<h2>S1B</h2>
<pre class="r"><code>strains &lt;- c(&quot;N2&quot;, &quot;rict-1(ft7)&quot;)
foods &lt;- &quot;OP50&quot;
rictC3 &lt;- read.csv(file.path(pathname, &#39;extdata/S3C_rict1Pheromone.csv&#39;)) %&gt;% format_dauer(p.dauer = &quot;exclude&quot;) %&gt;% mutate(plateID = interaction(plateID,concentration.uM.))

# for glm fit
glm &lt;- glm(data = rictC3, cbind(dauer, non) ~ concentration.uM. * genotype, family = binomial)

newdata = data.frame(genotype = rep(strains, each = 241), concentration.uM. = rep(seq(0,2.4, by = 0.01),2),plateID = rep(0, 482), n = rep(60, 482))

### for non-interaction ### 
glm.simple &lt;- glm(data = rictC3, cbind(dauer, non) ~ concentration.uM. + genotype, family = binomial)
predictions &lt;- predict(glm.simple, newdata = newdata, type = &quot;response&quot;, se.fit = TRUE)
newdata1 &lt;- cbind(newdata, predictions)
newdata1 %&lt;&gt;% mutate(lower = (fit - se.fit), upper = (fit + se.fit), pct = fit)


# # for GLMM
# glmm &lt;- glmer(data = rictC3, cbind(dauer, non) ~ concentration.uM. + genotype + (1|day/plateID), family = binomial)
# glmm.predict &lt;- predict(glmm,newdata=newdata,type = &quot;response&quot;, re.form = NA) #re.form = ~0)
# newdata2 &lt;- cbind(newdata, glmm.predict) %&gt;% mutate(pct = glmm.predict)
# 
# 
# # for Bayesian GLMM
# brms.glmm &lt;- brms::brm(data = rictC3, formula= dauer | trials(n) ~ concentration.uM. + genotype + (1|plateID), family = binomial)
# brms.predict &lt;- predict(brms.glmm,newdata=newdata,type = &quot;response&quot;, re.form = NA, allow_new_levels = TRUE)
# newdata3 &lt;- cbind(newdata, brms.predict) %&gt;% mutate(pct = Estimate/n)
#newdata3 &lt;- effects::effect(newdata, glmm)


(p&lt;-rictC3 %&gt;% ggplot(aes(x=concentration.uM.,y = pct)) +
  geom_ribbon(data = newdata1,aes(ymin=lower, ymax=upper,fill=genotype), alpha=0.3) +
  geom_line(data = newdata1,aes(x = concentration.uM., y = pct, colour = genotype)) +
  geom_point(aes(y=pct), size = 0.6, alpha = 0.75) +
  add.median.dauer() +
  labs(y = &quot;proportion dauer&quot;, 
       x = &quot;ascr#5 concentration (uM)&quot;) +
  facet_grid(.~genotype) +
  scale_fill_manual(values = c(&quot;grey&quot;, &quot;lightblue&quot;)) +
  scale_colour_manual(values = c(&quot;grey&quot;, &quot;lightblue&quot;)) +
  geom_text(aes(y = 1.075, x=concentration.uM.), label = &quot;&quot;) +
    coord_cartesian(ylim = c(-.005,1.075)) +
      scale_y_continuous(breaks=c(0,0.25,0.5,0.75,1)) +
  theme_classic() +
  theme(
        axis.text.x = element_text(size=16),
        axis.text.y = element_text(size=16),
        axis.title.y = element_text(size =20),
        axis.title.x = element_text(size=16),
        strip.text.x = element_blank(),
        panel.spacing = unit(2,&quot;lines&quot;)) +
    stat_summary(aes(x=concentration.uM. + 0.3, y=-.025),
                      fun.data = fun_length, geom = &quot;text&quot;, size = 4)
)</code></pre>
<p><img src="Figure_2_files/figure-html/rict-1%20pheromone%20response-1.png" width="672" /></p>
<p><strong>Figure S1B</strong> <em>rict-1</em> mutants show enhanced response to pheromone ascr#5. Dauers formed by wild-type (black) and rict-1(ft7) (blue) animals at 25°C in the presence of the indicated concentrations of ascr#5. Each dot indicates the proportion of dauers formed in a single assay. Horizontal bar indicates median. Numbers in parentheses below indicate the number of independent experiments with at least 27 animals each. Lines indicate predictions from GLM fit, corresponding to an odds ratio of ~88 for rict-1 across this range of ascr#5 concentrations. For genotype, Wald Χ<sup>2</sup> = 45.3, Df =1, p &lt; 0.0001; for pheromone, Wald Χ<sup>2</sup> = 24.9, Df =1, p &lt; 0.0001 with GLMM fit.</p>
<table>
<caption>odds-ratio for glm</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">OddsRatio</th>
<th align="right">Std. Err.</th>
<th align="right">z</th>
<th align="right">P&gt;|z|</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>concentration.uM.</td>
<td align="right">7.619807</td>
<td align="right">0.7829173</td>
<td align="right">19.76445</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>genotyperict-1(ft7)</td>
<td align="right">88.467217</td>
<td align="right">16.4359884</td>
<td align="right">24.12791</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
